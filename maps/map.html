<!DOCTYPE html>
<html>
  <head>
	<meta name="viewport" content="initial-scale=1.0, user-scalable=no" />
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
	<style type="text/css">
	  html { height: 100% }
	  body { height: 100%; margin: 0; padding: 0 }
	  #map-canvas { height: 100% }
	</style>

	<script type="text/javascript" src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBEPTzQE5w10jXl2qe7yEKuzpaXm8TeTHM&sensor=false"></script>
<script type="text/javascript">

	//getData();
	var arr = new Array(40);
	function getData()
	{
		//gone = true;
		var xmlhttp=new XMLHttpRequest();
		xmlhttp.onreadystatechange=function() 
		{
			if (xmlhttp.readyState==4 && xmlhttp.status==200)
			{
				// var a = xmlhttp.responseText;
				// console.log("RAW: " + a);
				var data=JSON.parse(xmlhttp.responseText);
				console.log("data2367876543234567 " + data);
				console.log("345678909876543456 " + data[0][0]);
				for (var x = 0; x < data[0].length; x++) 
				{
					var myLatlng = new google.maps.LatLng(parseFloat(data[0][x]),parseFloat(data[0][x]));
					arr[x] = myLatlng;
					console.log(arr[x]);
				}
				initialize(arr);
			}
		}
		xmlhttp.open("GET","locations.php" ,true);
		xmlhttp.send();
	}
	var contentString = new Array(20);
	contentString[0] = '<p>FIRST INFO WINDOW</p>';
	var infowindow = null;

	contentString[1] = '<p>7tfdgsuyhbckxj</p>';


	var markers = new Array(20);

	function initialize(arr)
	{
		var mapOptions = 
		{
			zoom: 4,
			center: arr[0]
		}

		var map = new google.maps.Map(document.getElementById('map-canvas'), mapOptions);

		for (var x = 0; x < arr.length; x++)
		{
			if (arr[x] != null)
			{
				var marker = new google.maps.Marker(
				{
					position: arr[x],
					map: map,
					title: 'Marker: ' + x + '!'
				});
				markers[x] = marker;
				// infowindow = new google.maps.InfoWindow
				// ({
				// 	content: contentString[x]
				// });
				// google.maps.event.addListener(marker, 'click', function ()
				// {
				// // where I have added .html to the marker object.
				// 	infowindow.setContent(contentString[x]);
				// 	infowindow.open(map, this);
				// });
			}
		}
		alert(markers.length);
		for (var i = 0; i < markers.length; i++)
		{
			var marker = markers[i];
			google.maps.event.addListener(marker, 'click', function ()
			{
			// where I have added .html to the marker object.
				infowindow.setContent(contentString[i]);
				infowindow.open(map, this);
			});
		}

// 		google.maps.event.addListener(markers[0], 'click', function()
// 		{
// //			alert("1");
// 	 		infowindow.setContent(contentString[0]);
// 			infowindow.open(map,marker[0]);
// 		});

// 		google.maps.event.addListener(markers[1], 'click', function()
// 		{
// //			alert("2");
// 			infowindow.setContent(contentString[1]);
// 			infowindow.open(map,marker[1]);
// 		});

	}


	google.maps.event.addDomListener(window, 'load', getData);
	</script>
</head>
  <body>
	<div id="map-canvas"> </div>
  </body>
</html>